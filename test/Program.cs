using MathNet.Numerics.IntegralTransforms;

double[] weights = new double[] {
  1.3870019465068615e-05, 4.313564569348816e-05, 9.892837395098251e-05, 
  5.934895117985429e-05, 4.1657575626930166e-05, 6.738527154134303e-05, 
  0.00014213989886547365, 0.00010700766577817803, 5.2750525304857835e-05, 
  3.5778103775882136e-05, 3.8205440056306245e-05, -2.1337893225894182e-05, 
  9.093677955381632e-06, 2.9947379962392004e-05, 2.7623657899970657e-05, 
  3.581396682035981e-06, -2.850404783946663e-05, -8.152726755011381e-05, 
  -8.919903913607539e-05, 4.882913426744099e-06, 4.1394597000482263e-05, 
  1.2024921079809641e-05, 2.6628108220205992e-06, -4.9274269286924874e-05, 
  -4.919111550114623e-05, 0.00012481632180263747, 0.0003276390007298714, 
  0.00017841104241752556, 4.996375488394727e-05, 4.5858194241904496e-05, 
  -7.742496620720455e-05, 8.712332680136825e-05, 0.00017162102886002087, 
  0.00045311513395966733, 0.000206594706715627, 0.00041226512057469767, 
  0.000543144609911776, 5.935889373870565e-05, 2.5431412390439862e-05, 
  0.00048366728040802147, -0.00048423509122271196, 2.1039204505622336e-05, 
  -0.0004296078735828951, -3.361403775658161e-05, -0.00047378175439483235, 
  -0.0010855225502114604
};
double[] test_signal = new double[] {
  17.999267578125, 19.01922607421875, 38.9984130859375, 
  40.01837158203125, 28.01885986328125, 2.9998779296875, 
  -13.01947021484375, -16.97930908203125, -8.9996337890625, 
  1.01995849609375, 4.97979736328125, 1.01995849609375, 
  -4.97979736328125, -32.9986572265625, -32.9986572265625, 
  -31.01873779296875, -29.998779296875, -17.999267578125, 
  -16.97930908203125, -8.9996337890625, 13.01947021484375, 
  2.9998779296875, -10.97955322265625, -46.97808837890625, 
  -58.01763916015625, -34.01861572265625, 13.01947021484375, 
  37.01849365234375, 55.01776123046875, 58.01763916015625, 
  49.01800537109375, 59.99755859375, 79.01678466796875, 
  77.996826171875, 58.01763916015625, 35.99853515625, 
  2.9998779296875, -5.999755859375, -4.01983642578125, 
  -2.9998779296875, 4.01983642578125, -20.9991455078125, 
  -22.01910400390625, -16.01934814453125, -10.01959228515625, 
  4.97979736328125, 10.01959228515625, 0.0, 
  -14.9993896484375, -31.97869873046875, -25.97894287109375, 
  -25.01898193359375, -35.99853515625, -61.01751708984375, 
  -92.9962158203125, -103.01580810546876, -85.97650146484375, 
  -62.9974365234375, -40.01837158203125, -7.01971435546875, 
  8.9996337890625, 16.97930908203125, 23.9990234375, 
  29.998779296875, 44.9981689453125, 34.97857666015625, 
  16.01934814453125, 19.01922607421875, -17.999267578125, 
  -46.01812744140625, -82.01666259765625, -94.01617431640624, 
  -88.01641845703125, -71.9970703125, -49.97796630859375, 
  -31.01873779296875, 7.97967529296875, 46.97808837890625, 
  82.01666259765625, 76.01690673828125, 67.97723388671875, 
  43.97821044921875, 20.9991455078125, 5.999755859375, 
  -1.97991943359375, 8.9996337890625, -4.97979736328125, 
  -13.97943115234375, -35.99853515625, -52.01788330078125, 
  -56.9976806640625, -37.97845458984375, -7.01971435546875, 
  31.97869873046875, 52.01788330078125, 43.97821044921875, 
  14.9993896484375, 8.9996337890625, 14.9993896484375, 
  25.97894287109375, 17.999267578125, 7.97967529296875, 
  17.999267578125, 20.9991455078125, 40.97833251953125, 
  53.997802734375, 64.01739501953125, 77.996826171875, 
  88.97637939453125, 91.97625732421876, 103.01580810546876, 
  79.97674560546875, 61.01751708984375, 17.999267578125, 
  -19.01922607421875, -31.97869873046875, -40.01837158203125, 
  -41.998291015625, -34.01861572265625, -22.01910400390625, 
  16.97930908203125, 26.9989013671875, 49.01800537109375, 
  35.99853515625, 17.999267578125, 1.01995849609375, 
  4.01983642578125, -16.01934814453125, -17.999267578125, 
  -26.9989013671875, -19.97918701171875, -11.99951171875, 
  -4.97979736328125, 4.97979736328125, 8.9996337890625, 
  8.9996337890625, 7.01971435546875, 13.97943115234375, 
  2.9998779296875, 10.01959228515625, 13.01947021484375, 
  7.01971435546875, 4.01983642578125, -20.9991455078125, 
  -46.97808837890625, -74.9969482421875, -88.97637939453125, 
  -100.97589111328124, -92.9962158203125, -83.99658203125, 
  -64.01739501953125, -25.97894287109375, -7.97967529296875, 
  16.97930908203125, 7.01971435546875, -1.97991943359375, 
  -10.01959228515625, -7.97967529296875, -11.99951171875, 
  -43.97821044921875, -67.01727294921875, -103.97576904296876, 
  -127.01483154296876, -131.99462890625, -106.97564697265624, 
  -61.01751708984375, -31.01873779296875, -7.97967529296875, 
  -8.9996337890625, -16.01934814453125, -23.9990234375, 
  -19.01922607421875, -28.97882080078125, -22.01910400390625, 
  -10.01959228515625, 2.9998779296875, -8.9996337890625, 
  -29.998779296875
};

double[] test_signal2 = new double[] {178.97271728515648, 235.01043701171898, 272.9888916015627, 296.0279541015627, 296.0279541015627, 312.9472656250002, 395.9838867187502, 557.9772949218752, 725.0104980468752, 816.026794433594, 764.0089111328127, 653.9733886718752, 492.999938964844, 260.9893798828127, -58.07763671874977, -439.0621337890623, -770.068664550781, -942.0816650390623, -945.0815429687498, -833.0661010742185, -690.0319213867185, -561.037170410156, -445.0618896484373, -334.0664062499998, -219.05108642578102, -97.07604980468727, 3.9598388671877274, 77.93682861328148, 151.91381835937523, 220.01104736328148, 307.007507324219, 436.0022583007815, 626.9744873046877, 770.0086669921877, 762.988952636719, 612.995056152344, 356.0255126953127, 51.95788574218773, -298.0678710937498, -666.0328979492185, -904.0432128906248, -965.0607299804685, -882.0841064453123, -738.0899658203123, -577.0565185546873, -407.0834350585935, -252.04974365234352, -120.05511474609352, -10.079589843749773, 100.91589355468773, 192.95214843750023, 271.008972167969, 319.007019042969, 362.0252685546877, 382.0044555664065, 391.004089355469, 395.0239257812502, 413.9831542968752, 497.9797363281252, 678.992370605469, 831.0261840820315, 927.9822387695315, 840.025817871094, 680.9722900390627, 449.9816894531252, 180.95263671875023, -170.03308105468727, -527.0785522460935, -814.0468749999998, -958.0410156249998, -953.0612182617185, -863.0648803710935, -732.0302124023435, -599.0756225585935, -471.040832519531, -335.0863647460935, -204.05169677734352, -75.05694580078102, 27.958862304687727, 89.93634033203148, 129.95471191406273, 170.99304199218773, 214.01129150390648, 295.007995605469, 464.0211181640627, 629.0144042968752, 722.0106201171877, 674.9725341796877, 528.998474121094, 341.9860839843752, 158.93353271484398, -142.07421874999977, -761.0690307617185, -898.0434570312498, -867.0847167968748, -747.0895996093748, -591.035949707031, -445.0618896484373, -299.0878295898435, -194.03210449218727, -81.05670166015602, 24.958984375000227, 122.93499755859398, 191.99218750000023, 248.02990722656273, 293.9880371093752, 314.0272216796877, 329.9865722656252, 326.0267333984377, 704.9713134765627, 581.0163574218752, 397.003845214844, 169.01312255859398, -154.07373046874977, -512.079162597656, -791.0678100585935, -926.062316894531, -889.0438232421873, -766.0488281249998, -635.0741577148435, -512.079162597656, -403.0635986328123, -295.0679931640623, -174.05291748046852, -57.05767822265602, 37.91845703125023, 107.93560791015648, 163.01336669921898, 196.97198486328148, 226.01080322265648, 284.9884033203127, 440.0220947265627, 626.9744873046877, 761.0090332031252, 720.990661621094, 572.0167236328127, 380.9844970703127, 199.97186279296898, -64.07739257812477, -401.0836791992185, -694.0517578124998, -869.0646362304685, -872.064514160156, -763.0489501953123, -615.034973144531, -478.0605468749998, -349.0657958984373, -246.04998779296852, -132.05462646484352, -25.078979492187273, 86.93646240234398, 166.01324462890648, 217.91113281250023, 254.02966308593773, 263.0292968750002, 302.0277099609377, 410.9832763671877, 563.9770507812502, 699.9915161132815, 731.0102539062502, 644.9737548828127, 521.9787597656252, 341.9860839843752, 158.93353271484398, -116.03527832031227, -424.0627441406248, -683.0722045898435, -842.065734863281, -838.0458984374998, -742.0498046874998, -608.075256347656, -472.0607910156248, -344.085998535156, -229.07067871093727, -114.05535888671852, -6.059753417968523, 104.93572998046898, 178.97271728515648};

double[] signalComplex = new double[178];

double[] signal = test_signal;

Fourier.Forward(signal, signalComplex, FourierOptions.NoScaling);

double sum = 0.0;
for (int i = 0; i <= 45; i++) {
  double psd = Math.Sqrt(signal[i] * signal[i] + signalComplex[i] * signalComplex[i]);
  Console.WriteLine(psd);
  sum += weights[i] * psd;
}