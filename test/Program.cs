using MathNet.Numerics.IntegralTransforms;

double[] weights = new double[] {
  1.3870019465068615e-05, 4.313564569348816e-05, 9.892837395098251e-05, 
  5.934895117985429e-05, 4.1657575626930166e-05, 6.738527154134303e-05, 
  0.00014213989886547365, 0.00010700766577817803, 5.2750525304857835e-05, 
  3.5778103775882136e-05, 3.8205440056306245e-05, -2.1337893225894182e-05, 
  9.093677955381632e-06, 2.9947379962392004e-05, 2.7623657899970657e-05, 
  3.581396682035981e-06, -2.850404783946663e-05, -8.152726755011381e-05, 
  -8.919903913607539e-05, 4.882913426744099e-06, 4.1394597000482263e-05, 
  1.2024921079809641e-05, 2.6628108220205992e-06, -4.9274269286924874e-05, 
  -4.919111550114623e-05, 0.00012481632180263747, 0.0003276390007298714, 
  0.00017841104241752556, 4.996375488394727e-05, 4.5858194241904496e-05, 
  -7.742496620720455e-05, 8.712332680136825e-05, 0.00017162102886002087, 
  0.00045311513395966733, 0.000206594706715627, 0.00041226512057469767, 
  0.000543144609911776, 5.935889373870565e-05, 2.5431412390439862e-05, 
  0.00048366728040802147, -0.00048423509122271196, 2.1039204505622336e-05, 
  -0.0004296078735828951, -3.361403775658161e-05, -0.00047378175439483235, 
  -0.0010855225502114604
};
double[] test_signal = new double[] {
  17.999267578125, 19.01922607421875, 38.9984130859375, 
  40.01837158203125, 28.01885986328125, 2.9998779296875, 
  -13.01947021484375, -16.97930908203125, -8.9996337890625, 
  1.01995849609375, 4.97979736328125, 1.01995849609375, 
  -4.97979736328125, -32.9986572265625, -32.9986572265625, 
  -31.01873779296875, -29.998779296875, -17.999267578125, 
  -16.97930908203125, -8.9996337890625, 13.01947021484375, 
  2.9998779296875, -10.97955322265625, -46.97808837890625, 
  -58.01763916015625, -34.01861572265625, 13.01947021484375, 
  37.01849365234375, 55.01776123046875, 58.01763916015625, 
  49.01800537109375, 59.99755859375, 79.01678466796875, 
  77.996826171875, 58.01763916015625, 35.99853515625, 
  2.9998779296875, -5.999755859375, -4.01983642578125, 
  -2.9998779296875, 4.01983642578125, -20.9991455078125, 
  -22.01910400390625, -16.01934814453125, -10.01959228515625, 
  4.97979736328125, 10.01959228515625, 0.0, 
  -14.9993896484375, -31.97869873046875, -25.97894287109375, 
  -25.01898193359375, -35.99853515625, -61.01751708984375, 
  -92.9962158203125, -103.01580810546876, -85.97650146484375, 
  -62.9974365234375, -40.01837158203125, -7.01971435546875, 
  8.9996337890625, 16.97930908203125, 23.9990234375, 
  29.998779296875, 44.9981689453125, 34.97857666015625, 
  16.01934814453125, 19.01922607421875, -17.999267578125, 
  -46.01812744140625, -82.01666259765625, -94.01617431640624, 
  -88.01641845703125, -71.9970703125, -49.97796630859375, 
  -31.01873779296875, 7.97967529296875, 46.97808837890625, 
  82.01666259765625, 76.01690673828125, 67.97723388671875, 
  43.97821044921875, 20.9991455078125, 5.999755859375, 
  -1.97991943359375, 8.9996337890625, -4.97979736328125, 
  -13.97943115234375, -35.99853515625, -52.01788330078125, 
  -56.9976806640625, -37.97845458984375, -7.01971435546875, 
  31.97869873046875, 52.01788330078125, 43.97821044921875, 
  14.9993896484375, 8.9996337890625, 14.9993896484375, 
  25.97894287109375, 17.999267578125, 7.97967529296875, 
  17.999267578125, 20.9991455078125, 40.97833251953125, 
  53.997802734375, 64.01739501953125, 77.996826171875, 
  88.97637939453125, 91.97625732421876, 103.01580810546876, 
  79.97674560546875, 61.01751708984375, 17.999267578125, 
  -19.01922607421875, -31.97869873046875, -40.01837158203125, 
  -41.998291015625, -34.01861572265625, -22.01910400390625, 
  16.97930908203125, 26.9989013671875, 49.01800537109375, 
  35.99853515625, 17.999267578125, 1.01995849609375, 
  4.01983642578125, -16.01934814453125, -17.999267578125, 
  -26.9989013671875, -19.97918701171875, -11.99951171875, 
  -4.97979736328125, 4.97979736328125, 8.9996337890625, 
  8.9996337890625, 7.01971435546875, 13.97943115234375, 
  2.9998779296875, 10.01959228515625, 13.01947021484375, 
  7.01971435546875, 4.01983642578125, -20.9991455078125, 
  -46.97808837890625, -74.9969482421875, -88.97637939453125, 
  -100.97589111328124, -92.9962158203125, -83.99658203125, 
  -64.01739501953125, -25.97894287109375, -7.97967529296875, 
  16.97930908203125, 7.01971435546875, -1.97991943359375, 
  -10.01959228515625, -7.97967529296875, -11.99951171875, 
  -43.97821044921875, -67.01727294921875, -103.97576904296876, 
  -127.01483154296876, -131.99462890625, -106.97564697265624, 
  -61.01751708984375, -31.01873779296875, -7.97967529296875, 
  -8.9996337890625, -16.01934814453125, -23.9990234375, 
  -19.01922607421875, -28.97882080078125, -22.01910400390625, 
  -10.01959228515625, 2.9998779296875, -8.9996337890625, 
  -29.998779296875
};

double[] test_signal2 = new double[] {8.939636230468977, 16.919311523437727, 23.939025878906477, 29.938781738281477, 44.93817138671898, 34.91857910156273, 15.959350585937727, 18.959228515625227, -18.059265136718523, -46.07812499999977, -82.07666015624977, -94.07617187499977, -88.07641601562477, -72.05706787109352, -50.03796386718727, -31.078735351562273, 7.919677734375227, 46.91809082031273, 81.95666503906273, 75.95690917968773, 67.91723632812523, 43.91821289062523, 20.939147949218977, 5.939758300781477, -2.0399169921872726, 8.939636230468977, -5.039794921874773, -14.039428710937273, -36.05853271484352, -52.07788085937477, -57.05767822265602, -38.03845214843727, -7.079711914062273, 31.918701171875227, 51.95788574218773, 43.91821289062523, 14.939392089843977, 8.939636230468977, 14.939392089843977, 25.918945312500227, 17.939270019531477, 7.919677734375227, 17.939270019531477, 20.939147949218977, 40.91833496093773, 53.93780517578148, 63.95739746093773, 77.93682861328148, 88.91638183593773, 91.91625976562523, 102.95581054687523, 79.91674804687523, 60.95751953125023, 17.939270019531477, -19.079223632812273, -32.03869628906227, -40.07836914062477, -42.05828857421852, -34.07861328124977, -22.079101562499773, 16.919311523437727, 26.938903808593977, 48.95800781250023, 35.93853759765648, 17.939270019531477, 0.9599609375002274, 3.9598388671877274, -16.079345703124773, -18.059265136718523, -27.058898925781023, -20.039184570312273, -12.059509277343523, -5.039794921874773, 4.919799804687727, 8.939636230468977, 8.939636230468977, 6.959716796875227, 13.919433593750227, 2.9398803710939774, 9.959594726562727, 12.959472656250227, 6.959716796875227, 3.9598388671877274, -21.059143066406023, -47.03808593749977, -75.05694580078102, -89.03637695312477, -101.03588867187477, -93.05621337890602, -84.05657958984352, -64.07739257812477, -26.038940429687273, -8.039672851562273, 16.919311523437727, 6.959716796875227, -2.0399169921872726, -10.079589843749773, -8.039672851562273, -12.059509277343523, -44.03820800781227, -67.07727050781227, -104.03576660156227, -127.07482910156227, -132.05462646484352, -107.03564453124977, -61.07751464843727, -31.078735351562273, -8.039672851562273, -9.059631347656023, -16.079345703124773, -24.059020996093523, -19.079223632812273, -29.038818359374773, -22.079101562499773, -10.079589843749773, 2.9398803710939774, -9.059631347656023, -30.058776855468523, 17.939270019531477, 18.959228515625227, 38.93841552734398, 39.95837402343773, 27.958862304687727, 2.9398803710939774, -13.079467773437273, -17.039306640624773, -9.059631347656023, 0.9599609375002274, 4.919799804687727, 0.9599609375002274, -5.039794921874773, -33.05865478515602, -33.05865478515602, -31.078735351562273, -30.058776855468523, -18.059265136718523, -17.039306640624773, -9.059631347656023, 12.959472656250227, 2.9398803710939774, -11.039550781249773, -47.03808593749977, -58.07763671874977, -34.07861328124977, 12.959472656250227, 36.95849609375023, 54.95776367187523, 57.95764160156273, 48.95800781250023, 59.93756103515648, 78.95678710937523, 77.93682861328148, 57.95764160156273, 35.93853759765648, 2.9398803710939774, -6.059753417968523, -4.079833984374773, -3.0598754882810226, 3.9598388671877274, -21.059143066406023, -22.079101562499773, -16.079345703124773, -10.079589843749773, 4.919799804687727, 9.959594726562727, -0.059997558593522626, -15.059387207031023, -32.03869628906227, -26.038940429687273, -25.078979492187273, -36.05853271484352, -61.07751464843727, -93.05621337890602, -103.07580566406227, -86.03649902343727, -63.05743408203102, -40.07836914062477, -7.079711914062273};
Queue<double> q_signal = new(test_signal2);

double[] signalComplex = new double[178];

double[] signal = q_signal.ToArray();

Fourier.Forward(signal, signalComplex, FourierOptions.NoScaling);

double sum = 0.0;
for (int i = 0; i <= 45; i++) {
  double psd = Math.Sqrt(signal[i] * signal[i] + signalComplex[i] * signalComplex[i]);
  Console.WriteLine(psd);
  sum += weights[i] * psd;
}